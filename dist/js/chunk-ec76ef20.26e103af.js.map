{"version":3,"sources":["webpack:///./src/components/admin/page.tsx","webpack:///./src/components/simplemde.tsx","webpack:///./src/views/rich-text/md.tsx"],"names":["GeminiScrollbar","Page","props","content","myScrollbar","scrollTop","$el","$scroll","element","value","create","_viewElement","destroy","position","background","color","height","overflow","padding","boxSizing","title","fontSize","marginBottom","letterSpacing","slots","default","type","String","Md","simplemde","$md","_value","modelValue","val","codemirror","setValue","readImg","file","Promise","resolve","reader","FileReader","readAsDataURL","onload","e","result","readMdFile","readAsText","isMdFile","name","test","isImgFile","renderingConfig","singleLineBreaks","codeSyntaxHighlighting","on","editor","dataTransfer","files","length","getValue","clipboardData","items","item","kind","getAsFile","indexOf","emit"],"mappings":"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","file":"js/chunk-ec76ef20.26e103af.js","sourcesContent":["import { defineComponent, getCurrentInstance, KeepAlive, ref, ComponentInternalInstance, VNode, onUnmounted, onMounted, onActivated, inject } from 'vue';\r\nimport { BackTop } from 'ant-design-vue'\r\nimport { onBeforeRouteLeave } from 'vue-router'\r\nconst GeminiScrollbar = require('gemini-scrollbar')\r\nimport 'gemini-scrollbar/gemini-scrollbar.css'\r\n\r\n\r\ninterface PageInterface {\r\n    color?: string\r\n    title?: string|VNode\r\n}\r\n\r\nconst Page = defineComponent((props: PageInterface, content) => {\r\n    const scrollTop = ref(0);\r\n    const $el: any = ref<Element | ComponentInternalInstance | null>(null);\r\n    const $scroll = ref();\r\n    let myScrollbar: any;\r\n\r\n    // onBeforeRouteLeave((to, from, next) => {\r\n    //     scrollTop.value = $el.value.scrollTop;\r\n    //     next();\r\n    // })\r\n\r\n    onMounted(() => {\r\n        \r\n        myScrollbar = new GeminiScrollbar({\r\n            element: $scroll.value\r\n        }).create();\r\n        $el.value = myScrollbar._viewElement;\r\n    })\r\n\r\n    onActivated(() => {\r\n        // console.log(getCurrentInstance())\r\n    })\r\n\r\n\r\n    onActivated(() => {\r\n        scrollTop.value && (myScrollbar._viewElement.scrollTop = scrollTop.value);\r\n    })\r\n\r\n    onUnmounted(() => {\r\n        myScrollbar.destroy();\r\n    })\r\n\r\n\r\n    return () => <div style={{ position: 'relative', background: props.color, height: '100%', overflow: 'auto'}}>\r\n        <div ref={$scroll}>\r\n            <div style={{ padding: '10px 20px', boxSizing: 'border-box' }}>\r\n                { props.title && <div style={{fontSize: '30px', marginBottom: '20px', letterSpacing: '2px'}}>{props.title}</div> }\r\n                { content.slots.default && content.slots.default() }\r\n            </div>\r\n            \r\n        </div>\r\n        \r\n        <BackTop target={() => $el.value} />\r\n    </div>\r\n\r\n})\r\nPage.props = {\r\n    color: {\r\n        type: String,\r\n        default: '#f5f5f5'\r\n    },\r\n    title: {\r\n        type: [String, String]\r\n    }\r\n}\r\n\r\nexport default Page;","import SimpleMDE from 'simplemde';\r\nimport { defineComponent, ref, onMounted, watch, onDeactivated, onUnmounted } from 'vue';\r\nimport 'simplemde/dist/simplemde.min.css'\r\n\r\nconst Md = defineComponent((props: { value?: string }, content) => {\r\n\r\n    let simplemde!: SimpleMDE\r\n\r\n    const $md = ref(null);\r\n    let _value: string = '';\r\n\r\n    watch(() => (props as any).modelValue, (val: string) => {\r\n        if(val == _value) return;\r\n        simplemde.codemirror.setValue(val)\r\n    })\r\n\r\n    const readImg = (file: File) => {\r\n        return new Promise(resolve => {\r\n            var reader = new FileReader();　　　　//实例化\r\n\t\t\treader.readAsDataURL(file);　　　　　　//加载\r\n\t\t\treader.onload = function (e) {\r\n\t\t\t\tresolve({type: 'img', content: reader.result})\r\n\t\t\t}\r\n        })\r\n    }\r\n\r\n    const readMdFile = (file: File) => {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tvar reader = new FileReader();\r\n\t\t\treader.onload = () => {\r\n\t\t\t\tresolve({type:'md',content: reader.result})\r\n\t\t\t};\r\n\t\t\treader.readAsText(file);\r\n\t\t})\r\n    }\r\n    \r\n    //判断是否为.md文件\r\n\tconst isMdFile = (name: string): boolean => {\r\n\t\treturn /^.*[.](md)$/.test(name)\r\n\t}\r\n\r\n\t//判断是否为图片文件\r\n\tconst isImgFile = (name: string): boolean => {\r\n\t\treturn /^.*[.](png|gif|jpe?g)$/.test(name)\r\n\t}\r\n\r\n    onMounted(() => {\r\n        \r\n        simplemde = new SimpleMDE({ \r\n            element: $md.value as any, \r\n            renderingConfig: {\r\n\t\t\t\tsingleLineBreaks: false,\r\n\t\t\t\tcodeSyntaxHighlighting: true,\r\n\t\t\t}\r\n        })\r\n        simplemde.codemirror.setValue((props as any).modelValue||props.value||'')\r\n        simplemde.codemirror.on('drop', async (editor: any, e: any) => {\r\n            if(e.dataTransfer.files.length == 0) return;\r\n            const file: File = e.dataTransfer.files[0];\r\n            let result: any;\r\n            if(isImgFile(file.name)) {\r\n                result = await readImg(file);\r\n                simplemde.codemirror.setValue(simplemde.codemirror.getValue()+'![]('+result.content+')');\r\n            } else if(isMdFile(file.name)) {\r\n                result = await readMdFile(file);\r\n                simplemde.codemirror.setValue(result.content)\r\n            }\r\n        })\r\n        simplemde.codemirror.on('paste', async (editor: any, e: any) => {\r\n            if(!e.clipboardData) return\r\n            if(!e.clipboardData.items) return\r\n            if(!e.clipboardData.items[0]) return\r\n            const item = e.clipboardData.items[0]\r\n            if(!item) return\r\n            if(item.kind === 'file' && item.getAsFile().type.indexOf('image') !== -1) {\r\n                const result: any = await readImg(item.getAsFile());\r\n                simplemde.codemirror.setValue(simplemde.codemirror.getValue()+'![]('+result.content+')');\r\n            }\r\n        })\r\n        simplemde.codemirror.on('change', () => {\r\n            _value = simplemde.codemirror.getValue();\r\n            content.emit('update:modelValue', _value)\r\n\t\t})\r\n    })\r\n\r\n\r\n    return () => <div class='md-container'>\r\n        <textarea ref={$md}></textarea>\r\n    </div>\r\n\r\n})\r\n\r\nMd.props = {\r\n    modelValue: String,\r\n    value: String\r\n} as any\r\n\r\nexport default Md","import { ref, defineComponent } from 'vue';\r\nimport Page from '@/components/admin/page';\r\nimport Md from '@/components/simplemde';\r\nimport { Card } from 'ant-design-vue';\r\nimport Br from '@/components/br';\r\n\r\n\r\nexport default defineComponent(() => {\r\n\r\n\r\n    const value = ref('222');\r\n\r\n    return () => <Page>\r\n        <Card title='编辑内容'>\r\n            {value.value}\r\n        </Card>\r\n        <Br />\r\n        <Md v-model={value.value} />\r\n    </Page>\r\n\r\n})"],"sourceRoot":""}